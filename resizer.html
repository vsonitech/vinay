<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Image Compressor</title>

<script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Inter',sans-serif;
}

body{
  background:linear-gradient(135deg,#e0f2fe,#f8fafc);
  padding-bottom:60px; /* space for fixed footer */
}

header{
  background:#0f172a;
  color:#fff;
  padding:16px;
  text-align:center;
  font-weight:600;
  font-size:18px;
}

.container{
  padding:20px;
  display:flex;
  justify-content:center;
}

.card{
  background:#fff;
  width:100%;
  max-width:850px;
  padding:25px;
  border-radius:18px;
  box-shadow:0 15px 40px rgba(0,0,0,0.08);
}

.upload-btn{
  display:inline-block;
  padding:12px 18px;
  background:#2563eb;
  color:#fff;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  transition:0.3s;
}

.upload-btn:hover{
  background:#1d4ed8;
}

input[type="file"]{
  display:none;
}

input[type="number"]{
  width:100%;
  padding:10px;
  margin-top:12px;
  border-radius:10px;
  border:1px solid #e2e8f0;
}

button{
  width:100%;
  padding:13px;
  margin-top:15px;
  border:none;
  border-radius:12px;
  background:#16a34a;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

.file-info{
  margin-top:15px;
  font-size:14px;
  background:#f1f5f9;
  padding:12px;
  border-radius:10px;
}

.progress{
  height:8px;
  background:#e2e8f0;
  border-radius:20px;
  margin-top:15px;
  overflow:hidden;
  display:none;
}

.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#16a34a,#22c55e);
  transition:0.3s;
}

.preview-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
  gap:12px;
  margin-top:20px;
}

.preview-item{
  background:#f1f5f9;
  padding:10px;
  border-radius:12px;
  text-align:center;
  font-size:12px;
}

.preview-item img{
  max-width:100%;
  border-radius:8px;
  margin-bottom:8px;
}

.download-btn{
  margin-top:8px;
  padding:6px 10px;
  background:#2563eb;
  color:white;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:12px;
}

footer{
  position:fixed;
  bottom:0;
  width:100%;
  background:#ffffff;
  text-align:center;
  padding:12px;
  font-size:13px;
  border-top:1px solid #e2e8f0;
  color:#64748b;
}

footer span{
  font-weight:600;
  color:#0f172a;
}
</style>
</head>

<body>

<header>Smart Image Compressor</header>

<div class="container">
<div class="card">

<label class="upload-btn">
  Choose Images
  <input type="file" id="imageInput" accept="image/*" multiple onchange="showFileInfo()">
</label>

<div class="file-info" id="fileInfo" style="display:none;"></div>

<input type="number" id="targetSize" placeholder="Enter max size in KB (e.g. 50)" value="50">

<button onclick="compressImages()">Compress Selected Images</button>

<div class="progress" id="progressContainer">
  <div class="progress-bar" id="progressBar"></div>
</div>

<div class="preview-grid" id="previewGrid"></div>

</div>
</div>

<footer>
  Professionally crafted by <span>Vinay S</span>
</footer>

<script>

function showFileInfo(){
  const files = document.getElementById('imageInput').files;
  const fileInfo = document.getElementById('fileInfo');

  if(files.length === 0){
    fileInfo.style.display="none";
    return;
  }

  let names = "";
  for(let i=0;i<files.length;i++){
    names += (i+1) + ". " + files[i].name + "<br>";
  }

  fileInfo.innerHTML = `
    <strong>${files.length} file(s) selected:</strong><br><br>
    ${names}
  `;
  fileInfo.style.display="block";
}

async function compressImages(){

  const files = document.getElementById('imageInput').files;
  const targetKB = parseInt(document.getElementById('targetSize').value);
  const progressBar = document.getElementById("progressBar");
  const progressContainer = document.getElementById("progressContainer");
  const previewGrid = document.getElementById("previewGrid");

  if(files.length === 0) return alert("Please select images.");
  if(!targetKB || targetKB <= 0) return alert("Enter valid target size.");

  previewGrid.innerHTML = "";
  progressContainer.style.display = "block";
  progressBar.style.width = "0%";

  let progressStep = 100 / files.length;

  for(let i=0; i<files.length; i++){

    let file = files[i];
    let quality = 0.9;
    let maxWidth = 1200;
    let compressedFile = file;

    while(compressedFile.size > targetKB * 1024 && quality > 0.05){
      const options = {
        maxWidthOrHeight:maxWidth,
        initialQuality:quality,
        useWebWorker:true
      };
      compressedFile = await imageCompression(file, options);
      quality -= 0.05;
      maxWidth -= 50;
    }

    const previewItem = document.createElement("div");
    previewItem.className = "preview-item";

    const img = document.createElement("img");
    img.src = URL.createObjectURL(compressedFile);

    const info = document.createElement("div");
    info.innerHTML = `
      <strong>${file.name}</strong><br>
      ${(compressedFile.size/1024).toFixed(1)} KB
    `;

    const downloadBtn = document.createElement("button");
    downloadBtn.className = "download-btn";
    downloadBtn.innerText = "Download";
    downloadBtn.onclick = function(){
      const a = document.createElement("a");
      a.href = img.src;
      a.download = "compressed_"+file.name;
      a.click();
    };

    previewItem.appendChild(img);
    previewItem.appendChild(info);
    previewItem.appendChild(downloadBtn);

    previewGrid.appendChild(previewItem);

    progressBar.style.width = ((i+1)*progressStep)+"%";
  }
}
</script>

</body>
  </html>
