<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Difference Arrear Sheet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            font-size: 12px;
        }
        /* --- Sheet Styles --- */
        .sheet-container {
            border: 1px solid #000;
            padding: 10px;
            background: #fff;
            max-width: 1400px;
            margin: 0 auto;
        }
        .header-banner {
            background-color: #395cb5;
            color: white;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            padding: 10px;
            margin-bottom: 5px;
        }
        
        .header-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
            padding: 0 10px;
        }
        .header-inputs .col {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .input-group {
            display: flex;
            align-items: center;
        }
        .input-group strong {
            width: 90px;
            font-size: 13px;
        }
        .input-group input {
            flex: 1;
            padding: 4px;
            border: 1px dashed #ccc;
            font-size: 13px;
            font-weight: bold;
        }
        
        .school-input {
            width: 100%;
            text-align: center;
            font-weight: bold;
            font-size: 14px;
            border: 1px dashed #ccc;
            padding: 5px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            font-size: 11px;
        }
        th, td {
            border: 1px solid #000;
            padding: 4px;
        }
        th { background-color: #e6f0ff; }
        .vertical-text {
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            white-space: nowrap;
            padding: 10px 2px !important;
        }
        
        /* Interactive cell styles */
        .calc-input {
            width: 45px;
            padding: 2px;
            border: 1px solid #007bff;
            text-align: center;
            font-size: 11px;
            color: #0000ff;
            background: #f8fbff;
        }
        .calc-input:focus { outline: 2px solid #0056b3; background: #fff; }
        
        .readonly {
            background: transparent;
            border: none;
            font-weight: bold;
            color: #000;
            width: 45px;
            text-align: center;
            pointer-events: none;
        }
        .red-text { color: #ff0000 !important; }
        .green-text { color: #00a000 !important; font-size: 12px; }
        .blue-text { color: #0000ff !important; }
        .text-left { text-align: left; padding-left: 10px; font-weight: bold; }
        
        .signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            padding: 0 40px;
        }
        .signatures div { text-align: center; font-weight: bold; }
        .sig-name {
            border: none;
            border-bottom: 1px dashed #000;
            text-align: center;
            font-weight: bold;
            margin-top: 5px;
        }

        .actions { margin: 20px auto; text-align: center; max-width: 1400px; }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover { background: #0056b3; }

        /* Print Specific Styles */
        @media print {
            .actions { display: none !important; }
            .sheet-container { border: none; padding: 0; }
            .input-group input, .school-input, .sig-name { border: none !important; background: transparent !important; }
            .calc-input { border: none !important; background: transparent !important; }
            @page { size: landscape; margin: 10mm; }
        }
    </style>
</head>
<body>

    <div class="actions">
        <button onclick="window.print()">Print / Save as PDF</button>
        <p style="color: #555; font-size: 12px; margin-top: 10px;">Type your base totals into the blue boxes. Formulas will calculate automatically.</p>
    </div>

    <div class="sheet-container" id="outputSheet">
        <div class="header-banner">Difference Arrear Sheet</div>
        <input type="text" class="school-input" value="OFFICE SCHOOL NAME GOES HERE">
        
        <div class="header-inputs">
            <div class="col">
                <div class="input-group"><strong>Name:</strong><input type="text" value="EMPLOYEE NAME" id="empName" oninput="document.getElementById('sigName').value = this.value"></div>
                <div class="input-group"><strong>Post:</strong><input type="text" value="SR. TEACHER"></div>
                <div class="input-group"><strong>Pay Matrix:</strong><input type="text" value="L-12"></div>
            </div>
            <div class="col">
                <div class="input-group"><strong>GPF/PRAN:</strong><input type="text" value="GPF-2004"></div>
                <div class="input-group"><strong>Arrear From:</strong><input type="text" value="Jul-25 to Oct-26"></div>
                <div class="input-group"><strong>Posting:</strong><input type="text" value="SCHOOL PLACE"></div>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th rowspan="2">Sr</th>
                    <th rowspan="2">Month</th>
                    <th colspan="4">Pay Due</th>
                    <th colspan="4">Pay Drawn</th>
                    <th colspan="4">Pay Diff</th>
                    <th colspan="3">NPS</th>
                    <th colspan="3">SI</th>
                    <th colspan="3">Corona</th>
                    <th colspan="3">RGHS</th>
                    <th rowspan="2" class="vertical-text">Arrear GPF</th>
                    <th rowspan="2" class="vertical-text">IT</th>
                    <th rowspan="2" class="vertical-text">Total Ded</th>
                    <th rowspan="2" class="vertical-text">Net Pay</th>
                    <th rowspan="2" class="vertical-text">Bill No</th>
                    <th rowspan="2" class="vertical-text">Encash</th>
                </tr>
                <tr>
                    <th>P</th><th>DA</th><th>H</th><th>T</th>
                    <th>P</th><th>DA</th><th>H</th><th>T</th>
                    <th>P</th><th>DA</th><th>H</th><th>T</th>
                    <th>D</th><th>Ded</th><th>Df</th>
                    <th>D</th><th>Ded</th><th>Df</th>
                    <th>D</th><th>Ded</th><th>Df</th>
                    <th>D</th><th>Ded</th><th>Df</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="2" style="font-weight: bold;">GRAND TOTAL</td>
                    <td><input type="number" id="due_p" class="calc-input" value="360000"></td>
                    <td><input type="number" id="due_da" class="calc-input" value="216000"></td>
                    <td><input type="number" id="due_h" class="calc-input" value="36000"></td>
                    <td><input type="text" id="due_t" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="number" id="drawn_p" class="calc-input" value="336000"></td>
                    <td><input type="number" id="drawn_da" class="calc-input" value="201600"></td>
                    <td><input type="number" id="drawn_h" class="calc-input" value="33600"></td>
                    <td><input type="text" id="drawn_t" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="text" id="diff_p" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="text" id="diff_da" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="text" id="diff_h" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="text" id="diff_t" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="number" id="nps_d" class="calc-input" value="6000"></td>
                    <td><input type="number" id="nps_ded" class="calc-input" value="4800"></td>
                    <td><input type="text" id="nps_df" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="number" id="si_d" class="calc-input" value="0"></td>
                    <td><input type="number" id="si_ded" class="calc-input" value="0"></td>
                    <td><input type="text" id="si_df" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="number" id="cor_d" class="calc-input" value="0"></td>
                    <td><input type="number" id="cor_ded" class="calc-input" value="0"></td>
                    <td><input type="text" id="cor_df" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="number" id="rghs_d" class="calc-input" value="2400"></td>
                    <td><input type="number" id="rghs_ded" class="calc-input" value="1200"></td>
                    <td><input type="text" id="rghs_df" class="readonly blue-text" tabindex="-1"></td>
                    <td><input type="number" id="gpf" class="calc-input" value="18000"></td>
                    <td><input type="number" id="it" class="calc-input" value="600"></td>
                    <td><input type="text" id="total_ded" class="readonly red-text" tabindex="-1"></td>
                    <td><input type="text" id="net_pay" class="readonly green-text" tabindex="-1"></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td colspan="2" style="font-weight: bold;">Net Pay (In Words)</td>
                    <td colspan="32" class="text-left" id="words_output">Rupees Zero Only</td>
                </tr>
            </tbody>
        </table>

        <div class="signatures">
            <div>
                Employee Name<br>
                <input type="text" class="sig-name" id="sigName" value="EMPLOYEE NAME">
            </div>
            <div>
                Drawing & Dispersal Officer<br>
                Signature & Seal
            </div>
        </div>
    </div>

    <script>
        // Number to Words function
        function numberToWords(num) {
            if (num === 0) return 'Zero Only';
            let a = ['','One ','Two ','Three ','Four ', 'Five ','Six ','Seven ','Eight ','Nine ','Ten ','Eleven ','Twelve ','Thirteen ','Fourteen ','Fifteen ','Sixteen ','Seventeen ','Eighteen ','Nineteen '];
            let b = ['', '', 'Twenty','Thirty','Forty','Fifty', 'Sixty','Seventy','Eighty','Ninety'];
            if ((num = num.toString()).length > 9) return 'Overflow';
            let n = ('000000000' + num).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
            if (!n) return; let str = '';
            str += (n[1] != 0) ? (a[Number(n[1])] || b[n[1][0]] + ' ' + a[n[1][1]]) + 'Crore ' : '';
            str += (n[2] != 0) ? (a[Number(n[2])] || b[n[2][0]] + ' ' + a[n[2][1]]) + 'Lakh ' : '';
            str += (n[3] != 0) ? (a[Number(n[3])] || b[n[3][0]] + ' ' + a[n[3][1]]) + 'Thousand ' : '';
            str += (n[4] != 0) ? (a[Number(n[4])] || b[n[4][0]] + ' ' + a[n[4][1]]) + 'Hundred ' : '';
            str += (n[5] != 0) ? ((str != '') ? 'and ' : '') + (a[Number(n[5])] || b[n[5][0]] + ' ' + a[n[5][1]]) : '';
            return str.trim() + ' Only';
        }

        // Main Calculation Function
        function calculateExcelLogics() {
            // Helper to get number from input safely
            const getVal = (id) => parseInt(document.getElementById(id).value) || 0;
            const setVal = (id, val) => document.getElementById(id).value = val;

            // 1. Calculate Pay Due Total
            let due_p = getVal('due_p'), due_da = getVal('due_da'), due_h = getVal('due_h');
            let due_t = due_p + due_da + due_h;
            setVal('due_t', due_t);

            // 2. Calculate Pay Drawn Total
            let drawn_p = getVal('drawn_p'), drawn_da = getVal('drawn_da'), drawn_h = getVal('drawn_h');
            let drawn_t = drawn_p + drawn_da + drawn_h;
            setVal('drawn_t', drawn_t);

            // 3. Calculate Pay Differences
            let diff_p = due_p - drawn_p;
            let diff_da = due_da - drawn_da;
            let diff_h = due_h - drawn_h;
            let diff_t = due_t - drawn_t;
            setVal('diff_p', diff_p);
            setVal('diff_da', diff_da);
            setVal('diff_h', diff_h);
            setVal('diff_t', diff_t);

            // 4. Calculate Deduction Differences
            let nps_df = getVal('nps_d') - getVal('nps_ded');
            setVal('nps_df', nps_df);

            let si_df = getVal('si_d') - getVal('si_ded');
            setVal('si_df', si_df);

            let cor_df = getVal('cor_d') - getVal('cor_ded');
            setVal('cor_df', cor_df);

            let rghs_df = getVal('rghs_d') - getVal('rghs_ded');
            setVal('rghs_df', rghs_df);

            // 5. Calculate Total Deductions
            let gpf = getVal('gpf');
            let it = getVal('it');
            let total_ded = nps_df + si_df + cor_df + rghs_df + gpf + it;
            setVal('total_ded', total_ded);

            // 6. Calculate Net Pay
            let net_pay = diff_t - total_ded;
            setVal('net_pay', net_pay);

            // 7. Update Words
            document.getElementById('words_output').innerText = 'Rupees ' + numberToWords(net_pay);
        }

        // Attach event listeners to all calc-inputs
        document.querySelectorAll('.calc-input').forEach(input => {
            input.addEventListener('input', calculateExcelLogics);
        });

        // Run calculation on page load
        calculateExcelLogics();
    </script>
</body>
                            </html>
    
